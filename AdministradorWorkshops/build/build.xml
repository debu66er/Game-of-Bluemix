<project name="AdministradorWorkshops Build Script" default="all" basedir=".">
	
	<property name="home_dir" value="${basedir}/../.."/>
	<property name="lib_dir" value="${basedir}/../lib"/>
	<property name="artifact_dir" value="${ARCHIVE_DIR}"/>

	<target name="all" depends="compile, package, deploy">
		<echo message="Build completed." />
	</target>
	
	<target name="compile">
		
		<mkdir dir="${home_dir}/AdministradorWorkshops/bin" />
		<mkdir dir="${home_dir}/AdministradorWorkshops/WebContent/WEB-INF/classes" />

		<javac srcdir="${home_dir}/AdministradorWorkshops/src" destdir="${home_dir}/AdministradorWorkshops/bin" source="1.5" target="1.5">
			<classpath>
				<pathelement path="${lib_dir}/com.ibm.ws.javaee.servlet.3.0_1.0.1.jar" />
				<pathelement path="${lib_dir}/postgresql-9.4.1208.jar" />
				<pathelement path="${lib_dir}/com.ibm.websphere.appserver.api.json_1.0.1.jar"/>
				<pathelement path="${lib_dir}/javacsv.jar"/>
			</classpath>
		</javac>

		<javac srcdir="${home_dir}/AdministradorWorkshops/src" destdir="${home_dir}/AdministradorWorkshops/WebContent/WEB-INF/classes" source="1.5" target="1.5">
			<classpath>
				<pathelement path="${lib_dir}/com.ibm.ws.javaee.servlet.3.0_1.0.1.jar"/>
				<pathelement path="${lib_dir}/postgresql-9.4.1208.jar" />
				<pathelement path="${lib_dir}/com.ibm.websphere.appserver.api.json_1.0.1.jar"/>
				<pathelement path="${lib_dir}/javacsv.jar"/>
			</classpath>
		</javac>
	</target>

	<target name="package">
					
		<mkdir dir="lib" />
		<jar destfile="lib/AdministradorWorkshops.jar" manifest="${home_dir}/AdministradorWorkshops/WebContent/META-INF/MANIFEST.MF">
			<fileset dir="${home_dir}/AdministradorWorkshops/bin" includes="**" />
		</jar>
		
		<copy todir="WEB-INF/lib">
			<fileset file="${lib_dir}/postgresql-9.4.1208.jar" />
			<fileset file="${lib_dir}/javacsv.jar" />
		</copy>

		<war destfile="AdministradorWorkshops.war" manifest="${home_dir}/AdministradorWorkshops/WebContent/META-INF/MANIFEST.MF" needxmlfile="false">
			<fileset dir="${home_dir}/AdministradorWorkshops/WebContent" includes="WEB-INF/classes/**" />
			<fileset dir="${home_dir}/AdministradorWorkshops/WebContent" includes="WEB-INF/lib/**" />
			<fileset dir="${home_dir}/AdministradorWorkshops/WebContent" includes="images/**" />
			<fileset dir="${home_dir}/AdministradorWorkshops/WebContent" includes="documents/**"></fileset>
			<fileset dir="${home_dir}/AdministradorWorkshops/WebContent" includes="*.html" />
			<fileset dir="${home_dir}/AdministradorWorkshops/WebContent" includes="*.jsp" />
			<fileset dir="${home_dir}/AdministradorWorkshops/WebContent" includes="*.css" />
		</war>

		<jar destfile="AdministradorWorkshops.ear" basedir="${basedir}">
			<include name="lib/AdministradorWorkshops.jar" />
			<include name="lib/postgresql-9.4.1208.jar" />
			<include name="lib/com.ibm.ws.javaee.servlet.3.0_1.0.1.jar" />
			<include name="lib/com.ibm.webshpere.appserver.api.json_1.0.1.jar" />
			<include name="lib/javacsv.jar"/>
			<include name="AdministradorWorkshops.war" />
		</jar>
	</target>
				
	<target name="deploy">
		<copy todir="${artifact_dir}">
			<fileset file="${home_dir}/AdministradorWorkshops/WebContent/manifest.yml" />
			<fileset file="AdministradorWorkshops.ear" />
	    </copy>
	</target>
</project>